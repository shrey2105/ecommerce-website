{% extends 'home/base.html' %}
{% block title %}Sign Up{% endblock title %}
{% block css %}
.form-signup {
    width: 100%;
    max-width: 495px;
    padding: 15px;
    margin: auto;
}
.form-signup .text-center {
    text-align: center!important;
}
.form-signup .mb-4, .form-signup .my-4 {
    margin-bottom: 1.5rem!important;
}
.form-signup img{
    vertical-align: middle;
    border-style: none;
}
.form-signup .font-weight-normal {
    font-weight: 400!important;
}
.form-signup .text-center p {
    margin-top: 0;
    margin-bottom: 1rem;
}
.form-signup .form-label-group {
    position: relative;
    margin-bottom: 1rem;
}
.form-signup .form-label-group > input, .form-label-group > label {
    height: 3.125rem;
    padding: .75rem;
}
.form-signup .form-control {
    display: block;
    width: 100%;
    height: calc(1.5em + .75rem + 2px);
    padding: .375rem .75rem;
    font-size: 1rem;
    font-weight: 400;
    line-height: 1.5;
    color: #495057;
    background-color: #fff;
    background-clip: padding-box;
    border: 1px solid #ced4da;
    border-radius: .25rem;
    transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}
.form-signup .form-label-group > label {
    position: absolute;
    top: 0;
    left: 0;
    display: block;
    width: 100%;
    margin-bottom: 0;
    line-height: 1.5;
    color: #495057;
    pointer-events: none;
    cursor: text;
    border: 1px solid transparent;
    border-radius: .25rem;
    transition: all .1s ease-in-out;
}
.form-signup .form-label-group input::-webkit-input-placeholder {
  color: transparent;
}

.form-signup .form-label-group input:-ms-input-placeholder {
  color: transparent;
}

.form-signup .form-label-group input::-ms-input-placeholder {
  color: transparent;
}

.form-signup .form-label-group input::-moz-placeholder {
  color: transparent;
}

.form-signup .form-label-group input::placeholder {
  color: transparent;
}

.form-signup .form-label-group input:not(:placeholder-shown) {
  padding-top: 1.25rem;
  padding-bottom: .25rem;
}

.form-signup .form-label-group input:not(:placeholder-shown) ~ label {
  padding-top: .25rem;
  padding-bottom: .25rem;
  font-size: 12px;
  color: #777;
}
{% endblock css %}

{% block body %}
<div class="container">
<form class="form-signup" id="signup-form" action="/blog/signup" method="post" novalidate="">{% csrf_token %}
  <div class="text-center mb-4">
    {% comment %} <img class="mb-4" src="/docs/4.5/assets/brand/bootstrap-solid.svg" alt="" width="72" height="72"> {% endcomment %}
    <h1 class="my-3">New to Devastator Blogs!</h1>
    <h1 class="h3 mb-3 font-weight-normal">Please Sign Up</h1>
  </div>

  <div class="form-label-group">
    <input type="text" class="form-control" pattern="^(?=.*[a-zA-Z])(?=.*[0-9])[a-zA-Z0-9]+$" id="username" name="username" placeholder="Username" required="" autofocus="">
    <label for="username">Username</label>
    <div class="valid-feedback" id="username_valid" style="display:none">Username Available</div>
    <div class="invalid-feedback" id="username_response" style="display:none">Username Unavailable</div>
       <div class="invalid-feedback">
        Username invalid. Should contain: altleast 1 alphabet and 1 numeric 
    </div>
  </div>

  <div class="form-label-group">
    <input type="text" class="form-control" pattern="^[A-Za-z. ]{3,20}$" id="firstname" name="firstname" placeholder="First Name" required="">
    <label for="firstname">First Name</label>
    <div class="valid-feedback">Done</div>
    <div class="invalid-feedback">
        First name invalid. Should contain: atleast 3 albhabets. No numeric allowed
    </div>
  </div>

  <div class="form-label-group">
    <input type="text" class="form-control" pattern="^[A-Za-z. ]{3,20}$" id="lastname" name="lastname" placeholder="Last Name" required="">
    <label for="lastname">Last Name</label>
    <div class="valid-feedback">Done</div>
    <div class="invalid-feedback">
        Last name invalid. Should contain: atleast 3 albhabets. No numeric allowed
    </div>
  </div>

  <div class="form-label-group">
    <input type="email" class="form-control" id="email" name="email" placeholder="Email Address" required="">
    <label for="email">Email Address</label>
    <div class="valid-feedback">Done</div>
    <div class="invalid-feedback">
        Email invalid. Should contain atleast 3 characters.
    </div>
  </div>

  <div class="form-label-group">
    <input type="password" pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$" class="form-control pwds" id="password1" name="password1" placeholder="Password" required="">
    <label for="password1">Password</label>
    <div class="valid-feedback">Done</div>
    <div class="invalid-feedback" id="pwd1invalid">
        Password invalid. Should contain atleast 1 uppercase, 1 lowecase and 1 numeric. Special characters allowed
    </div>
  </div>

  <div class="form-label-group">
    <input type="password" pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$" class="form-control pwds" id="password2" name="password2" placeholder="Confirm Password" required="">
    <label for="password2">Confirm Password</label>
    <div id="pwd2valid" class="valid-feedback">Password Matched</div>
    <div id="pwd2invalid" class="invalid-feedback">
        Password Didn't Matched
    </div>
  </div>

  <button id="submit-button" class="btn btn-lg btn-primary btn-block" type="submit">Sign Up</button>
</form>
</div>
{% endblock body %}

{% block js %}
<script>
$(document).ready(function(){

 $('#username').on("blur", function(){
  var formData = {
			"username":$("input[name=username]").val(),
			"csrfmiddlewaretoken":$("input[name=csrfmiddlewaretoken]").val()
		};

  $.ajax({
    url: '/blog/signupcheck',
    type: 'post',
    data: formData,
	success: function(msg){
        var hasNumber = /\d/;
        if((msg == "OK") && ((formData.username).length > 4) && (hasNumber.test(formData.username)))
        {
            $("#username_valid").show()
            $("#username_response").hide()
        }
        else
        {
             $("#username_valid").hide()
            $("#username_response").show()
            $("#username").val("");    
        }
    }
});
});

$('#password1, #password2').on("hover", function(){
  var formData = {
			"password1":$("input[name=password1]").val(),
            "password2":$("input[name=password2]").val(),
			"csrfmiddlewaretoken":$("input[name=csrfmiddlewaretoken]").val()
		};

  $.ajax({
    url: '/blog/passwordcheck',
    type: 'post',
    data: formData,
	success: function(msg){
        if(msg == "OK"){
            $('#pwd1invalid').hide();
            $('#pwd2invalid').hide();
            $('#pwd2valid').show();
        }
        else{
            $('#pwd2invalid').show();
             $('#pwd2valid').hide();
            $("#password2").val("");
        }
    }
});
});


//$('#password1, #password2').on('keyup', function () {
 //       if ($('#password1').val() != '' && $('#password2').val() != '' && $('#password1').val() == $('#password2').val()) {
  //        $("#submit-button").attr("disabled",false);
  //         $('#pwd1invalid').hide();
    //      $('#pwd2invalid').hide();
 //         $('#pwd2valid').html('Password Matched').css('color', 'green');
  //      } else {
   //       $("#submit-button").attr("disabled",true);
     //     $('#pwd2invalid').show();
       //   }
     // });

let currForm1 = document.getElementById('signup-form');
        // Validate on submit:
        currForm1.addEventListener('submit', function(event) {
          if (currForm1.checkValidity() === false) {
            event.preventDefault();
            event.stopPropagation();
          }
          currForm1.classList.add('was-validated');
        }, false);
        // Validate on input:
        currForm1.querySelectorAll('.form-control').forEach(input => {
          input.addEventListener(('input'), () => {
            if (input.checkValidity()) {
              input.classList.remove('is-invalid')
              input.classList.add('is-valid');
            } else {
              input.classList.remove('is-valid')
              input.classList.add('is-invalid');
            }
            
          });
        });
      });


</script>
{% endblock %}